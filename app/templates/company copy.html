{% extends "base.html" %}

{% block app_content %}
    <div class='container'>
        <h3>Configurar Perfil</h3>
        <div class='row'>
          <div class="col-6">
          <h4><strong> {{ empresa.store_name }} </strong> <br></h4>
          </div>
          <div class="col-6">
          <small class="float-right">Si necesitas ayuda para configurar tu tienda, podés hacer click <a href="http://www.borisreturns.com/faq" target="_blank">acá</a></small>
          </div>
        </div>
        <br>
        <div class="card overflow-hidden">
          <div class="row no-gutters row-bordered row-border-light">
            <div class="col-md-3 pt-0">
              <div class="list-group list-group-flush ">

                {% if pestaña == 'tienda' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#empresa">Datos del Merchant</a>
                {% else %}
                  <a class="list-group-item list-group-item-action" data-toggle="list" href="#empresa">Datos del Merchant</a>
                {% endif %}

                {% if pestaña == 'carrier' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#correo">Empresas de Correo</a>
                {% else %}
                  <a class="list-group-item list-group-item-action" data-toggle="list" href="#correo">Empresas de Correos</a>
                {% endif %}

                {% if pestaña == 'envios' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#envios">Métodos de Envío</a>
                {% else %}
                  <a class="list-group-item list-group-item-action" data-toggle="list" href="#envios">Métodos de Envío</a>
                {% endif %}

                {% if pestaña == 'motivos' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#motivos">Motivos</a>
                {% else %}
                <a class="list-group-item list-group-item-action" data-toggle="list" href="#motivos">Motivos</a>
                {% endif %}

                {% if pestaña == 'portal' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#portal">Cofiguracion Portal</a>
                {% else %}
                <a class="list-group-item list-group-item-action" data-toggle="list" href="#portal">Cofiguracion Portal</a>
                {% endif %}

                {% if pestaña == 'mailsportal' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#mails_portal">Mails Portal</a>
                {% else %}
                <a class="list-group-item list-group-item-action" data-toggle="list" href="#mails_portal">Mails Portal</a>
                {% endif %}

                {% if pestaña == 'mailsback' %}
                  <a class="list-group-item list-group-item-action active" data-toggle="list" href="#mails_backoffice">Mails Backoffice</a>
                {% else %}
                  <a class="list-group-item list-group-item-action" data-toggle="list" href="#mails_backoffice">Mails Backoffice</a>
                {% endif %}

              </div>
            </div>

            <div class="col-md-9">
              <div class="tab-content">

                <!---------------- Datos Empresa / contacto -------------------------------->
                {% if pestaña == 'tienda' %}
                  <div class="tab-pane fade active show" id="empresa">
                {% else %}
                  <div class="tab-pane fade" id="empresa">
                {% endif %}

                  <div class="card-body">

                    <form id="store_info" action="{{ url_for('main.edit_storeinfo') }}" method="POST"> 
                      <!---------------- Datos Tienda ------------------------------------------------->
                      <div class = "page-header text-info font-weight-bold"> 
                        <h4> Datos del Mechant </h4>
                      </div>
                      <br>
                      <div class="card">
                        <div class="card-body">
                          <small>
                            <div class = "text-info"> 
                              <h5> Datos de la Tienda </h5>
                            </div>
                            <div class="form-group">
                              <label for="store_name">Tienda</label>
                              <input type="text" class="form-control form-control-sm" name="store_name" id="store_name" value="{{ empresa.store_name or ''}}">
                            </div>
                            <div class="form-group">
                              <label for="store_address">Dirección</label>
                              <input type="text" class="form-control form-control-sm" name="store_address" id="store_address" value="{{ empresa.store_address or ''}}" placeholder="Dirección">
                            </div>
                            <div class="form-row">
                              <div class="form-group col-md-4">
                                <label for="admin_email">Mail Administración</label>
                                <input type="email" class="form-control form-control-sm" name="admin_email" id="admin_email" value="{{empresa.admin_email or ''}}" placeholder="Email Administración">
                              </div>
                              <div class="form-group col-md-4">
                                <label for="idfiscal">CUIT</label>&nbsp;<small>(con guiones)</small>
                                <input type="text" class="form-control form-control-sm" name="idfiscal" id="idfiscal" value="{{empresa.store_idfiscal or ''}}" placeholder="CUIT">
                              </div>
                              <div class="form-group col-md-4">
                                <label for="store_phone">Teléfono</label>
                                <input type="text" class="form-control form-control-sm" name="store_phone" id="store_phone" value="{{empresa.store_phone or ''}}" placeholder="Teléfono Tienda">
                              </div>
                            </div>
                            <div class="form-group row">
                              <div class="form-check col-auto">
                                {% if empresa.stock_vuelve_config == true %}
                                  <input class="form-check-input ml-2" type="checkbox" name ="stock_vuelve_config" id="stock_vuelve_config" checked>
                                {% else %}
                                  <input class="form-check-input ml-2" type="checkbox" name ="stock_vuelve_config" id="stock_vuelve_config" >
                                {% endif %}
                                <label class="form-check-label ml-4" for="stock_vuelve_config">
                                  El stock se gestiona directamente en la Tienda? 
                                </label>
                              </div>
                            </div>
                          </small>
                      
                          <!---------------- Datos Tienda - Solo lectura -------------------------------->
                          <div class="alert alert-secondary mt-3"> 
                            <p> <small>
                              <strong>Plataforma/ID:</strong> {{empresa.platform}}/{{empresa.store_id}}<br>
                              <strong>URL: </strong>{{empresa.store_url}}<br>
                              <strong>Pais:</strong> {{empresa.store_country or ''}} &nbsp;&nbsp; <strong>Idioma:</strong> {{empresa.store_main_language or ''}}
                              &nbsp;&nbsp; <strong>Moneda:</strong> {{empresa.store_main_currency or ''}}
                            </small></p> 
                          </div>
                          <hr>
                          <br>

                          <!---------------- Datos del contacto -------------------------------->
                          <div class = "text-info "> 
                            <h5> Datos del Contacto </h5>
                          </div>
                          <small>
                            <div class="form-group">
                              <label for="contact_name">Nombre</label>
                              <input type="text" class="form-control form-control-sm" name="contact_name" id="contact_name" value="{{empresa.contact_name or ''}}" placeholder="Nombre del contacto">
                            </div>
                            <div class="form-row">
                              <div class="form-group col-md-6">
                                <label for="contact_email">Mail Contacto</label>
                                <input type="email" class="form-control form-control-sm" name="contact_email" id="contact_email" value="{{empresa.contact_email or ''}}" placeholder="Email Contacto">
                              </div>
                              <div class="form-group col-md-6">
                                <label for="contact_phone">Telefono</label>
                                <input type="text" class="form-control form-control-sm" name="contact_phone" id="contact_phone" value="{{empresa.contact_phone or ''}}" placeholder="Telefono Contacto">
                              </div>
                            </div>
                          </small>
                          <hr>

                          <!---------------- Datos para recepciond de productos -------------------------------->
                          <div class = "text-info "> 
                            <h5> Datos para Recepción de productos </h5>
                          </div>
                          <small>
                            <div class="form-row">
                              <div class="form-group col-md-6">
                                <label for="shipping_address">Calle</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_address" id="shipping_address" value="{{empresa.shipping_address or ''}}" placeholder="Calle para Recepción">
                              </div>
                              <div class="form-group  col-md-3">
                                <label for="shipping_number">Número</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_number" id="shipping_number" value="{{empresa.shipping_number or ''}}" placeholder="Número">
                              </div>
                              <div class="form-group  col-md-3">
                                <label for="shipping_floor">Piso</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_floor" id="shipping_floor" value="{{empresa.shipping_floor or ''}}" placeholder="Piso">
                              </div>
                            </div>
                            <div class="form-row">
                              <div class="form-group col-md-2">
                                <label for="shipping_zipcode">Código Postal</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_zipcode" id="shipping_zipcode" value="{{empresa.shipping_zipcode or ''}}" placeholder="Código Postal">
                              </div>
                              <div class="form-group col-md-4">
                                <label for="shipping_city">Ciudad</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_city" id="shipping_city" value="{{empresa.shipping_city or ''}}" placeholder="Ciudad">
                              </div>
                              <div class="form-group col-md-4">
                                <label for="shipping_province">Provincia</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_province" id="shipping_province" value="{{empresa.shipping_province or ''}}" placeholder="Provincia">
                              </div>
                              <div class="form-group col-md-2">
                                <label for="shipping_country">Pais</label>
                                <input type="text" class="form-control form-control-sm" name="shipping_country" id="shipping_country" value="{{empresa.shipping_country or ''}}" placeholder="Pais">
                              </div>
                            </div>

                            <div class="form-group">
                              <label for="shipping_info">Nota para Recepción</label>
                              <input type="text" class="form-control form-control-sm" name="shipping_info" id="shipping_info" value="{{empresa.shipping_info or ''}}" placeholder="Notas">
                            </div>
                          
                          </small>
                          <br>
                          <button name="boton" type="submit" class="btn btn-primary mt-2" value="guardar"> Guardar Cambios </button>
                          <button name="boton" type="submit" class="btn btn-danger mt-2 float-right" value="cancelar"> Salir </button>
                   
                        </div>


                      </div> <!--end card Merchant body-->

                    </form>
                  </div>
                </div>


                <!---------------- Datos Para ENVIO -  -------------------------------->
                {% if pestaña == 'carrier' %}
                  <div class="tab-pane fade active show" id="correo">
                {% else %}
                  <div class="tab-pane fade" id="correo">
                {% endif %}

                  <div class="card-body">  
                    <div class = "page-header text-info font-weight-bold"> 
                      <h4> Empresas de Correo Utilizadas </h4>
                    </div>
                    <br>

                    <!-- Formulario para agregar un correo -->
                    <div class="card">
                      <div class="card-body">
                        <div class = "text-info"> 
                          <h5> Agregar una nueva empresa de correo<br>
                            <small><small>Esta opción se utiliza EXCLUSIVAMENTE si se va a utilizar uno de los correos integrados con BORIS. Antes de configurar esta opción tenes que ponerte en contacto con nosotros a admin@borisreturns.com para que te proporcionemos los datos necesarios.</small></small>
                          </h5>
                          
                        </div>
                        
                        <small>

                          <form id="correo_add" action="{{ url_for('main.add_correo') }}" method="POST">       
                            <div class="form-group">
                              <label for="correo_usado">Nuevo Correo</label> 
                              <select class="custom-select custom-select-sm" name="correo_usado" id="correo_usado" placeholder="Empresa de Correo" >
                                <option selected disabled>Selecciona una Empresa de Correo</option>
                                {% for un_correo in lista_correos %}
                                  {% if un_correo.correo_id != 'NONE' %}
                                    <option value="{{ un_correo.correo_id }}">{{ un_correo.correo_descripcion }}</option>
                                  {% endif %}
                                {% endfor %}
                              </select>
                            </div>

                            <div class="form-row ">
                              <div class="form-group col-md-6">  
                                <label for="nuevo_correo_API">Api Key</label> 
                                <input type="text" class="form-control form-control-sm" name="nuevo_correo_API" id="nuevo_correo_API" placeholder="API key para el correo seleccionado">
                              </div> 

                              <div class="form-group col-md-6">  
                                <label for="nuevo_correo_id_cliente">ID de Cliente</label> <small>(si fuera necesario)</small>
                                <input type="text" class="form-control form-control-sm" name="nuevo_correo_id_cliente" id="nuevo_correo_id_cliente" placeholder="Id del Cliente">
                              </div> 

                            </div>

                            <div class="form-group col-md-2"> 
                              <button name="agregar" type="submit" class="btn btn-primary btn-sm mt-2" value="agregar"> Agregar </button>
                            </div>
                                  
                          </form>
                        </small>
                      </div>
                    </div>
                    <!-- FIN Formulario para agregar correos -->
                    <hr>
                    
                    <div class="card">
                      <div class="card-body">
                        <div class = "text-info"> 
                          <h5> Correos Utilizados</h5>
                        </div>
                        <small>
                          {% for empresa_correo in correos_activos %} 
                            <form id="correos_activos_info" action="{{ url_for('main.editar_correo', id= empresa_correo.correo_id) }}" method="POST"> 
                              <div class="card">
                                <div class="card-body">
                                  <div class = "text-info"> 
                                    <strong> {{ empresa_correo.correo_id }}</strong>
                                  </div>

                                  <div class="form-group">  
                                      <label for="correo_API">Api Key</label> 
                                      <input type="password" class="form-control form-control-sm" name="correo_API" id="correo_API" value="{{ empresa_correo.cliente_apikey }}">
                                  </div> 
                                  
                                  
                                  <div class="form-group">  
                                    <label for="correo_cliente_id">ID de Cliente </label> 
                                    <input type="password" class="form-control form-control-sm" name="correo_cliente_id" id="correo_cliente_id" value="{{ empresa_correo.cliente_id }}">
                                  </div> 
                                  

                                  <div class="form-group col-md-4">
                                  <br>
                                    <button name="boton_correo" type="submit" class="btn btn-outline-info btn-sm mt-2" value="update"> Actualizar </button>
                                    <button name="boton_correo" type="submit" class="btn btn-sm btn-outline-danger mt-2 ml-4" value="eliminar"> Eliminar </button>
                                  </div>
                                </div>
                              </div>
                              <br>
                            </form>
                          {% endfor %}
                        </small>
                      </div>
                    </div>
                  </div>
                </div>
                
                

                <!---------------- Configuracion del Portal  -------------------------------->
                {% if pestaña == 'portal' %}
                  <div class="tab-pane fade active show" id="portal">
                {% else %}
                  <div class="tab-pane fade" id="portal">
                {% endif %}
                  <div class="card-body">
                    <form id="portal_info" action="{{ url_for('main.edit_portalinfo') }}" method="POST" enctype="multipart/form-data"> 
                      <div class = "page-header text-info font-weight-bold"> 
                        <h4> Configuración del Portal para clientes</h4>
                      </div>
                      <br>
                      <div class="card">
                        <div class="card-body">
                          <small>
                          <p class="float-right">
                          Link portal consumidor: <a href='http://frontprod.borisreturns.com/buscar?empresa={{empresa.store_id}}'  target="_blank" rel="noreferrer noopener">Hace click aqui para ver tu portal</a>
                          </p>  
                          <br>
                          <div class = "text-info mt-2"> 
                            <h5>Imagenes</h5>
                          </div>
                          <div class="form-group">
                            <label for="param_logo">Logo</label>
                            <input type="text" class="form-control form-control-sm" name="param_logo" id="param_logo" value="{{ empresa.param_logo or ''}}" placeholder="Logo">
                            <small>Si queres cambiar el logo de tu tienda, nos lo tenes que enviar por mail a soporte@borisreturns.com para que podamos publicarlo, luego te enviaremos el link para que pudas modificarlo</small>
                          </div>
                          <div class="form-group">
                            <label for="param_fondo">Imagen fondo</label>
                            <input type="text" class="form-control form-control-sm" name="param_fondo" id="param_fondo" value="{{ empresa.param_fondo or '' }}" placeholder="Seleccioná la imagen de Fondo - Solo disponible para el Plan Enterprise" readonly>
                            {% if empresa.plan_boris == 'Plan_D' %}
                              <input class="mt-2" type="file" name="file_fondo" accept="image/*"> <br>
                              <p>El archivo debe ser JPG o PNG y NO debe pesar mas de 10MB</p>
                            {% endif %}
                          </div>
                          <hr> 
                          <div class = "text-info mt-2"> 
                            <h5>Política de Cambios y Devoluciones</h5>
                          </div>
                          <div class="form-row">
                            <div class="form-group col-md-6">
                              <label for="ventana_cambios">Dias para realizar cambios</label> 
                              <input type="integer" class="form-control form-control-sm" name="ventana_cambios" id="ventana_cambios" value="{{ configuracion.ventana_cambios }}">
                            </div>
                            <div class="form-group col-md-6">
                              <label for="ventana_devolucion">Dias para realizar Devoluciones</label> 
                              <input type="integer" class="form-control form-control-sm" name="ventana_devolucion" id="ventana_devolucion" value="{{ configuracion.ventana_devolucion }}">
                            </div>
                            <br> 
                          </div>
                          <hr>
                          <div class = "text-info mt-2"> 
                            <h5>Opciones para cambios</h5>
                          </div>
                          <div class="form-group row">
                            <div class="form-check col-md-4">
                              {% if configuracion.cambio_otra_cosa == true %}
                                <input class="form-check-input ml-2" type="checkbox" name ="cambio_otra_cosa" id="cambio_otra_cosa" checked>
                              {% else %}
                                <input class="form-check-input ml-2" type="checkbox" name ="cambio_otra_cosa" id="cambio_otra_cosa" >
                              {% endif %}
                              <label class="form-check-label ml-5" for="cambio_otra_cosa">
                                Habilitar cambio por Otro Producto 
                              </label>
                            </div>
                            <div class="form-check col-md-4">
                              {% if configuracion.cambio_cupon == true %}
                                <input class="form-check-input" type="checkbox" name ="cambio_cupon" id="cambio_cupon" checked>
                              {% else %}
                                <input class="form-check-input" type="checkbox" name ="cambio_cupon" id="cambio_cupon" >
                              {% endif %}
                              <label class="form-check-label" for="cambio_cupon">
                                Habilitar cambio por Cupón
                              </label>
                            </div>

                            <div class="form-check col-md-4">
                              {% if configuracion.observaciones == true %}
                                <input class="form-check-input" type="checkbox" name ="observaciones" id="observaciones" checked>
                              {% else %}
                                <input class="form-check-input" type="checkbox" name ="observaciones" id="observaciones" >
                              {% endif %}
                              <label class="form-check-label" for="observaciones">
                                Habilitar Observaciones 
                              </label>
                            </div>
                          </div>
                          <hr> 
                          <div class = "text-info mt-2"> 
                            <h5 style="display:inline">Textos</h5>
                            <small class="text-muted"><a href="http://www.borisreturns.com/faq#textos" target="_blank">(que es esto?)</a></small>
                          </div>
                          <div class="form-group mt-2">
                            <label for="portal_empresa">Nombre de Tienda en el portal</label>
                            <input type="text" class="form-control form-control-sm" name="portal_empresa" id="portal_empresa" value="{{ configuracion.portal_empresa or '' }}">
                          </div>
                          <div class="form-group mt-2">
                              <label for="portal_titulo">Título para el portal</label>
                              <input type="text" class="form-control form-control-sm" name="portal_titulo" id="portal_titulo" value="{{ configuracion.portal_titulo or '' }}">
                          </div>
                          <div class="form-group mt-2">
                              <label for="portal_texto">Texto al pie del portal</label>
                              <input type="text" class="form-control form-control-sm" name="portal_texto" id="portal_texto" value="{{ configuracion.portal_texto or '' }}">
                          </div>
                            <div class="form-group mt-2">
                              <label for="cambio_opcion">Accion cambios</label>
                              <input type="text" class="form-control form-control-sm" name="cambio_opcion" id="cambio_opcion" value="{{ configuracion.cambio_opcion or '' }}">
                            </div>
                            <div class="form-group ">
                              <label for="cambio_opcion_cupon">Cambio por cupon</label> 
                              <input type="text" class="form-control form-control-sm" name="cambio_opcion_cupon" id="cambio_opcion_cupon" value="{{ configuracion.cambio_opcion_cupon or ''}}">
                            </div>
                            <div class="form-group ">
                              <label for="cambio_opcion_otra_cosa">Cambio por otro producto</label> 
                              <input type="text" class="form-control form-control-sm" name="cambio_opcion_otra_cosa" id="cambio_opcion_otra_cosa" value="{{ configuracion.cambio_opcion_otra_cosa or ''}}">
                            </div>
                          
                          </small>
                          <br>
                          <button name="boton" type="submit" class="btn btn-primary mt-2" value="guardar"> Guardar Cambios </button>
                         <button name="boton" type="submit" class="btn btn-danger mt-2 float-right" value="cancelar"> Salir </button>
                        </div>
                      </div>
                      
                      
                    </form>
                  </div>
                </div>


                <!---------------- Motivos -------------------------------->
                {% if pestaña == 'motivos' %}
                  <div class="tab-pane fade  active show" id="motivos">
                {% else %}
                  <div class="tab-pane fade" id="motivos">
                {% endif %}
                    <div class="card-body">
                      <div class = "page-header text-info font-weight-bold"> 
                        <h4> Motivos  </h4>
                      </div>
                      <br>
                      <div class="card">
                        <div class="card-body">
                          <small>
                          <!-- Formulario para agregar motivos -->
                          <div class = "text-info"> 
                            <h5> Agregar un motivo nuevo: </h5>
                          </div>
                          <form id="motivos_add" action="{{ url_for('main.add_motivo') }}" method="POST"> 
                            <div class="form-row align-items-center">
                              <div class="form-group col-md-8">
                                  <label for="nuevo_motivo">Motivo</label> 
                                  <input type="text" class="form-control form-control-sm" name="nuevo_motivo" id="nuevo_motivo" >
                              </div>
                              <div class="form-group col-md-2">  
                                <label for="tipo_nuevo_motivo">Tipo</label> 
                                <select class="custom-select custom-select-sm" name="tipo_nuevo_motivo" id="tipo_nuevo_motivo" >
                                  <option selected disabled>Tipo</option>                  
                                  <option value="Talle">Talle</option>
                                  <option value="Calce">Color</option>
                                  <option value="Calce">Calce</option>
                                  <option value="Calidad">Calidad</option>
                                  <option value="Expectativa">Expectativa</option>
                                  <option value="Otros">Otros</option>
                                </select> 
                              </div> 
                              <div class="form-group col-md-2"> 
                                <br>
                                <button name="agregar" type="submit" class="btn btn-primary btn-sm mt-2" value="agregar"> Agregar </button>
                              </div>
                            </div>
                          </form>
                          <!-- FIN Formulario para agregar motivos -->

                          <hr>
                          <div class = "text-info"> 
                            <h5> Motivos </h5>
                          </div>
                          
                          
                          {% for m in motivos %}
                          <form id="motivos_info" action="{{ url_for('main.editar_motivo', id=m.id_motivo) }}" method="POST"> 
                            <input type="hidden" id="motivos" name="motivos" value="{{ m.id_motivo }}">
                            <div class="form-row align-items-center">
                                <div class="form-group col-md-6">
                                  <label for="motivo">Motivo</label> 
                                  <input type="text" class="form-control form-control-sm" name="motivo" id="motivo" value="{{m.motivo}}">
                                </div>
                                <div class="form-group col-md-2">                          
                                  <label for="tipo_motivo">Tipo</label> 
                                  <select class="custom-select custom-select-sm" name="tipo_motivo" id="tipo_motivo" >
                                    {% if (m.tipo_motivo == none) or (m.tipo_motivo == '')%}
                                      <option selected disabled>Tipo</option>
                                    {% else %}
                                      <option disabled>Tipo</option>
                                    {% endif %}

                                    {% if m.tipo_motivo == 'Talle' %}
                                      <option selected value="Talle">Talle</option>
                                    {% else %}
                                      <option value="Talle">Talle</option>
                                    {% endif %}

                                    {% if m.tipo_motivo == 'Color' %}
                                      <option selected value="Color">Color</option>
                                    {% else %}
                                      <option value="Color">Color</option>
                                    {% endif %}

                                    {% if m.tipo_motivo == 'Calce' %}
                                      <option selected value="Calce">Calce</option>
                                    {% else %}
                                      <option value="Calce">Calce</option>
                                    {% endif %}

                                    {% if m.tipo_motivo == 'Calidad' %}
                                      <option selected value="Calidad">Calidad</option>
                                    {% else %}
                                      <option value="Calidad">Calidad</option>
                                    {% endif %}

                                    {% if m.tipo_motivo == 'Expectativa' %}
                                      <option selected value="Expectativa">Expectativa</option>
                                    {% else %}
                                      <option value="Expectativa">Expectativa</option>
                                    {% endif %}

                                    {% if m.tipo_motivo == 'Otros' %}
                                      <option selected value="Otros">Otros</option>
                                    {% else %}
                                      <option value="Otros">Otros</option>
                                    {% endif %}
                                  </select>                              
                                </div>

                                <div class="form-group col-md-4">
                                  <br>
                                  <button name="boton" type="submit" class="btn btn-outline-info btn-sm mt-2" value="update"> Actualizar </button>
                                  <button name="boton" type="submit" class="btn btn-sm btn-outline-danger mt-2 ml-4" value="eliminar"> Eliminar </button>
                                </div>
                                
                              </div>
                            </form>
                            {% endfor %}

                            </small>
                          </div>
                        </div>
                    </div>
                  </div>
                <!-- END OF MOTIVOS -->



                <!---------------- Metodos de Envio  -------------------------------->
                {% if pestaña == 'envios' %}
                  <div class="tab-pane fade  active show" id="envios">
                {% else %}
                  <div class="tab-pane fade" id="envios">
                {% endif %}
                
                  <div class="card-body">
                      <div class = "page-header text-info font-weight-bold"> 
                        <h4> Métodos de Envío </h4>
                      </div>
                      <br>

                    <!-- Formulario para agregar un Metodo de Envio -->
                    <div class="card">
                      <div class="card-body">
                        <div class = "text-info"> 
                          <h5> Agregar un nuevo Método de Envío</h5>
                        </div>

                        <small>
                          <form id="envios_add" action="{{ url_for('main.add_envio') }}" method="POST"> 
                            <div class="form-group">
                              <label for="nuevo_metodo_envio">Nuevo Método de Envío</label> 
                              <select class="custom-select custom-select-sm" name="nuevo_metodo_envio" id="nuevo_metodo_envio" >
                                <option selected disabled>Selecciona un Método de Envio</option>
                                {% for un_metodo in lista_metodos %}
                                    <option value="{{ un_metodo.metodo_envio_id }}">{{ un_metodo.metodo_envio_id }}</option>
                                {% endfor %}
                              </select>
                            </div>

                            <strong class = "text-info">Botón en el portal:</strong><br>
                            <div class="form-group">
                              <label for="nuevo_titulo_boton">Título</label> 
                              <input type="text" class="form-control form-control-sm" name="nuevo_titulo_boton" id="nuevo_titulo_boton">
                            </div>
                            <div class="form-group">
                              <label for="nuevo_descripcion_boton">Descripción</label> 
                              <textarea class="form-control form-control-sm" name="nuevo_descripcion_boton" id="nuevo_descripcion_boton" ></textarea> 
                            </div> 
                            
                            <div id="bloque_correo">
                              <strong class = "text-info">Empresa de correo:</strong><br>
                              <div class="form-row mt-2 align-items-center">
                                <div class="form-group col-md-6">
                                  <label for="nuevo_metodo_envio_correo">Correo</label> 
                                  <select class="custom-select custom-select-sm" name="nuevo_metodo_envio_correo" id="nuevo_metodo_envio_correo" placeholder="Empresa de Correo">
                                    <option selected disabled>Selecciona una empresa de correo</option>
                                    {% for un_correo in correos_activos %}
                                        <option value="{{ un_correo.correo_id }}">{{ un_correo.correo_id }}</option>
                                    {% endfor %}
                                  </select>
                                </div>
                              
                                <div class="form-group col-md-3">
                                  <label for="nuevo_metodo_envio_correo_servicio">Codigo del Servicio</label> 
                                  <input type="text" class="form-control form-control-sm" name="nuevo_metodo_envio_correo_servicio" id="nuevo_metodo_envio_correo_servicio">
                                </div>
                              
                            
                                <div class="form-group col-md-3">
                                  <label for="nuevo_metodo_envio_correo_sucursal">Código de Sucursal</label> 
                                  <input type="text" class="form-control form-control-sm" name="nuevo_metodo_envio_correo_sucursal" id="nuevo_metodo_envio_correo_sucursal">
                                </div>
                              </div>
                          
                              <fieldset class="form-group">
                                <div class="row">
                                  <legend class="col-form-label col-sm-2 pt-0">Costo del envío</legend>
                                  <div class="col-sm-10">
                                    <div class="form-check">
                                      <input class="form-check-input" type="radio" name="nuevo_shipping" id="shipping_customer" value="Customer">
                                      <label class="form-check-label" for="shipping_customer">
                                        A cargo del Cliente 
                                      </label>
                                    </div>
                                    <div class="form-check">
                                      <input class="form-check-input" type="radio" name="nuevo_shipping" id="shipping_company" value="Merchant">
                                      <label class="form-check-label" for="shipping_company">
                                        A cargo del Merchant
                                      </label>
                                    </div>
                                  </div>
                                </div>
                              </fieldset>
                            </div> <!-- Fin bloque correo-->

                            <strong class = "text-info">Instrucciones para el Envío:</strong><br>
                            <div class="form-group">
                              <label for="nuevo_instrucciones">Instrucciones</label> 
                              <textarea class="form-control form-control-sm" name="nuevo_instrucciones" id="nuevo_instrucciones" ></textarea> 
                            </div> 

                            <div class="form-group col-md-2"> 
                              <button name="agregar" type="submit" class="btn btn-primary btn-sm mt-2" value="agregar"> Agregar </button>
                            </div>

                          </form>
                        </small>
                      </div>
                    </div>
                    <hr>


                    <div class = "text-info"> 
                      <h5> Métodos de Envío utilizados</h5>
                    </div>

                    {% for e in envios %}
                    <form id="envios_info" action="{{ url_for('main.editar_envio', id=e.metodo_envio_id) }}" method="POST"> 
                      <input type="hidden" id="metodos_envio_id" name="metodos_envio_id" value="{{ e.metodo_envio_id }}">
                      <div class="card mb-4">
                        <div class="card-body">
                          <div class="form-group row">
                            <div class="form-check col-md-9">
                              <h5 class="text-info" style="text-transform:uppercase">{{e.metodo_envio_id}}</h5>
                            </div>
                            <div class="form-check col-md-3">
                              {% if e.habilitado == true %}
                                <input class="form-check-input" type="checkbox" name ="habilitado" id="habilitado" checked>
                              {% else %}
                                <input class="form-check-input" type="checkbox" name ="habilitado" id="habilitado" >
                              {% endif %}
                              <label class="form-check-label" for="habilitado">Habilitado</label>
                            </div>
                          </div>
                          <hr>

                          <small>
                            <strong>Botón en el portal:</strong><br>
                              <div class="form-group">
                                <label for="titulo_boton">Título</label> 
                                <input type="text" class="form-control form-control-sm" name="titulo_boton" id="titulo_boton" value="{{ e.titulo_boton or ''}}">
                              </div>

                              <div class="form-group">
                                <label for="descripcion_boton">Descripción</label> 
                                <textarea class="form-control form-control-sm" name="descripcion_boton" id="descripcion_boton" value="{{ e.descripcion_boton or ''}}">{{ e.descripcion_boton or ''}}</textarea> 
                              </div> 

                              {% if e.correo_id %}
                                <strong class = "text-info">Empresa de correo:</strong><br>
                                <div class="form-row mt-2 align-items-center">
                                  <div class="form-group col-md-6">
                                    <label for="metodo_envio_correo">Correo</label> 
                                    <select class="custom-select custom-select-sm" name="metodo_envio_correo" id="metodo_envio_correo">
                                        <option disabled>Selecciona una empresa de correo</option>
                                      
                                    

                                      {% for un_correo in correos_activos %}
                                          {% if un_correo.correo_id == e.correo_id %}
                                            <option selected value="{{ un_correo.correo_id }}">{{ un_correo.correo_id }}</option>
                                          {% else %}
                                            <option value="{{ un_correo.correo_id }}">{{ un_correo.correo_id }}</option>
                                          {% endif %}
                                      {% endfor %}
                                    </select>
                                  </div>
                              
                                  <div class="form-group col-md-3">
                                    <label for="metodo_envio_correo_servicio">Codigo del Servicio</label> 
                                    <input type="text" class="form-control form-control-sm" name="metodo_envio_correo_servicio" id="metodo_envio_correo_servicio" value="{{e.correo_servicio}}">
                                  </div>
                              
                            
                                  <div class="form-group col-md-3">
                                    <label for="metodo_envio_correo_sucursal">Código de Sucursal</label> 
                                    <input type="text" class="form-control form-control-sm" name="metodo_envio_correo_sucursal" id="metodo_envio_correo_sucursal" value="{{e.correo_sucursal}}">
                                  </div>

                                </div>
                                
                                <fieldset class="form-group">
                                  <div class="row">
                                    <legend class="col-form-label col-sm-2 pt-0">Costo del envío</legend>
                                    <div class="col-sm-10">
                                      <div class="form-check">
                                        {% if (e.costo_envio == 'Customer') or (e.costo_envio == None) %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_customer" value="Customer" checked>
                                        {% else %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_customer" value="Customer">
                                        {% endif %}
                                        <label class="form-check-label" for="shipping_customer">
                                          A cargo del Cliente 
                                        </label>
                                      </div>
                                      <div class="form-check">
                                        {% if e.costo_envio == 'Merchant' %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_company" value="Merchant" checked>
                                        {% else %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_company" value="Merchant">
                                        {% endif %}
                                        <label class="form-check-label" for="shipping_company">
                                          A cargo del Merchant
                                        </label>
                                      </div> 
                                    </div>
                                  </div>
                                </fieldset>
                                <!-- Agregado para conocer si se cotiza cvon Retiro + Entrega -->
                                <fieldset class="form-group">
                                  <div class="row">
                                    <legend class="col-form-label col-sm-2 pt-0">Cotiza con Retiro + Entrega ?</legend>
                                    <div class="col-sm-10">
                                      <div class="form-check">
                                        {% if (e.costo_envio == 'Customer') or (e.costo_envio == None) %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_customer" value="Customer" checked>
                                        {% else %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_customer" value="Customer">
                                        {% endif %}
                                        <label class="form-check-label" for="shipping_customer">
                                          Si 
                                        </label>
                                      </div>
                                      <div class="form-check">
                                        {% if e.costo_envio == 'Merchant' %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_company" value="Merchant" checked>
                                        {% else %}
                                          <input class="form-check-input" type="radio" name="shipping" id="shipping_company" value="Merchant">
                                        {% endif %}
                                        <label class="form-check-label" for="shipping_company">
                                          No
                                        </label>
                                      </div> 
                                    </div>
                                  </div>
                                </fieldset>

                              {% endif %}
                              <strong class = "text-info">Instrucciones para el Envío:</strong><br>
                              <div class="form-group">
                                <label for="instrucciones">Instrucciones</label> 
                                <textarea class="form-control form-control-sm" name="instrucciones" id="instrucciones" value="{{e.instrucciones_entrega}}">{{e.instrucciones_entrega or ''}}</textarea> 
                              </div> 

                          </small>
                        </div>
                        <div class="form-group col-md-4">
                          <br>
                          <button name="boton" type="submit" class="btn btn-outline-info btn-sm mt-2" value="update"> Actualizar </button>
                          <button name="boton" type="submit" class="btn btn-sm btn-outline-danger mt-2 ml-4" value="eliminar"> Eliminar </button>
                        </div>
                      </div>
                      <br>
                    </form>
                    {% endfor %}
                   
                  
                    </div>
                  </div>   
                  
                  <!---------------- Mails Portal -------------------------------->
                  {% if pestaña == 'mailsportal' %}
                    <div class="tab-pane fade active show" id="mails_portal">
                  {% else %}
                    <div class="tab-pane fade" id="mails_portal">
                  {% endif %}
                    <div class="card-body">
                      <form id="mailsportal_info" action="{{ url_for('main.edit_mailsportalinfo') }}" method="POST"> 
                        <div class = "page-header text-info font-weight-bold"> 
                          <h4> Mails desde el Portal </h4>
                        </div>
                        <br>
                        <div class="card">
                          <div class="card-body">
                            <div class = "text-info"> 
                              <h5> Mail Inicio de Solicitud: </h5>
                            </div>
                                                
                            <small>

                              <div class="form-group">
                                <label for="asunto_solicitado">Asunto para Mail de Solicitud</label> 
                                <input type="text" class="form-control form-control-sm" name="asunto_solicitado" id="asunto_solicitado" value="{{empresa.orden_solicitada_asunto or ''}}">{{ empresa.orden_solicitada_asunto or ''}}
                              </div>

                              <div class="form-group">
                                <label for="confirma_manual_note">Nota para Inicio de Envios Manuales:</label> 
                                <textarea class="form-control form-control-sm" name="confirma_manual_note" id="confirma_manual_note" value="{{ empresa.confirma_manual_note }}">{{ empresa.confirma_manual_note or ''}}</textarea> 
                              </div> 
                              
                              <div class="form-group">
                                <label for="confirma_coordinar_note">Nota para Inicio de Envios a coordinar:</label> 
                                <textarea class="form-control form-control-sm" name="confirma_coordinar_note" id="confirma_coordinar_note">{{ empresa.confirma_coordinar_note or ''}}</textarea> 
                              </div> 
                              
                              <div class="form-group">
                                <label for="confirma_domicilio_note">Nota para Inicio de Envios Domicilio:</label> 
                                <textarea class="form-control form-control-sm" name="confirma_domicilio_note" id="confirma_domicilio_note" >{{ empresa.confirma_domicilio_note or ''}}</textarea> 
                              </div> 
                            </small>
                            <br>
                            <button name="boton" type="submit" class="btn btn-primary mt-2" value="guardar"> Guardar Cambios </button>
                            <button name="boton" type="submit" class="btn btn-danger mt-2 float-right" value="cancelar"> Salir </button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>

                  <!---------------- Mails Backoffice  -------------------------------->
                  {% if pestaña == 'mailsback' %}
                    <div class="tab-pane fade active show" id="mails_backoffice">
                  {% else %}
                    <div class="tab-pane fade" id="mails_backoffice">
                  {% endif %}
                    <div class="card-body">
                      <form id="mailsback_info" action="{{ url_for('main.edit_mailsbackinfo') }}" method="POST"> 
                        <div class = "page-header text-info font-weight-bold"> 
                          <h4> Mails desde el Backoffice </h4>
                        </div>
                        <br>
                        <div class="card">
                          <div class="card-body">
                            <small>
                              <div class="form-row">
                                <div class="form-group col-md-6">
                                  <label for="communication_email">Dirección de mail para las Comunicaciones:</label> 
                                  {% if empresa.plan_boris != 'Plan_D' %}
                                    <input type="email" class="form-control form-control-sm" name="communication_email" id="communication_email" value="{{ empresa.communication_email or ''}}" readonly>
                                  {% else %}
                                  <input type="email" class="form-control form-control-sm" name="communication_email" id="communication_email" value="{{ empresa.communication_email or ''}}">
                                  {% endif %}
                                </div>
                                <div class="form-group col-md-6">
                                  <label for="communication_email_name">Nombre para el envío:</label> 
                                  {% if (empresa.plan_boris != 'Plan_C') and (empresa.plan_boris != 'Plan_D') %}
                                    <input type="text" class="form-control form-control-sm" name="communication_email_name" id="communication_email" value="{{ empresa.communication_email_name or ''}}" readonly>
                                  {% else %}
                                    <input type="text" class="form-control form-control-sm" name="communication_email_name" id="communication_email" value="{{ empresa.communication_email_name or ''}}" >
                                  {% endif %}
                                </div>
                                <p>
                                  {% if (empresa.plan_boris != 'Plan_C') and (empresa.plan_boris != 'Plan_D') %}
                                    El cambio de nombre para el envío está disponible para los planes PRO y ENTERPRISE <br>
                                    El cambio de la cuenta de mail solo para el Plan ENTERPRISE
                                  {% endif %}
                                  {% if empresa.plan_boris == 'Plan_C' %}
                                    El cambio de la cuenta de mail solo para el Plan ENTERPRISE
                                  {% endif %}
                                  {% if empresa.plan_boris == 'Plan_D' %}
                                      La cuenta de mail debe ser primero autorizada, por lo que si queres cambiarla envianos primero un mail a soporte@borisreturns.com
                                  {% endif %}
                                </p>

                              </div>
                              <hr>
                              
                              <div class = "text-info mt-2"> 
                                <h5> Mail CONFIRMACION: </h5>
                              </div>
                                <p>Este mail se envía al confirmar una orden. <br>
                                  Dependiendo del método de envío elegido por el cliente va a añadir al cuerpo del mail el texto que se haya definido en las 
                                  instrucciones del método de envío correspondiente.<br>
                                </p>
                                                           
                              <div class="form-group">
                                  <label for="asunto_confirmado">Asunto para Mail de Confirmación</label> 
                                  <input type="text" class="form-control form-control-sm" name="asunto_confirmado" id="asunto_confirmado" value="{{empresa.orden_confirmada_asunto}}">
                              </div>
                              <!-- 
                              <div class="form-group">
                                  <label for="envio_manual_note">Nota para envios Manuales:</label> 
                                  <textarea class="form-control form-control-sm" name="envio_manual_note" id="envio_manual_note" >{{ empresa.envio_manual_note or ''}}</textarea> 
                              </div> 
                              <div class="form-group">
                                <label for="envio_coordinar_note">Nota para envios a coordinar:</label> 
                                <textarea class="form-control form-control-sm" name="envio_coordinar_note" id="envio_coordinar_note" >{{ empresa.envio_coordinar_note or '' }}</textarea> 
                              </div> 
                              <div class="form-group">
                                <label for="envio_correo_note">Nota para envios por Correo:</label> 
                                <textarea class="form-control form-control-sm" name="envio_correo_note" id="envio_correo_note" >{{ empresa.envio_correo_note or '' }}</textarea> 
                              </div> 
                              -->
                              <hr>
                              
                              <div class = "text-info mt-2"> 
                                <h5>Mail APROBACION: </h5>
                              </div>
                              <p>Este mail se envía, luego de recibir los productos y aprobar la orden. <br> </p>
                              <div class="form-group">
                                <label for="asunto_aprobado">Asunto para mail de aprobación</label> 
                                <input type="text" class="form-control form-control-sm" name="asunto_aprobado" id="asunto_aprobado" value="{{empresa.orden_aprobada_asunto}}">
                              </div>
                              <div class="form-group">
                                <label for="aprobado_note">Nota mail de aprobación:</label> 
                                <textarea class="form-control form-control-sm" name="aprobado_note" id="aprobado_note" >{{ empresa.aprobado_note or '' }}</textarea> 
                              </div> 
                              <hr>
                              
                              <div class = "text-info mt-2"> 
                                <h5>Mail RECHAZO: </h5>
                              </div>
                              <p>Este mail se envía al rechazar una orden. <br> </p>
                              <div class="form-group">
                                <label for="asunto_rechazado">Asunto para solicitudes rechazadas</label> 
                                <input type="text" class="form-control form-control-sm" name="asunto_rechazado" id="asunto_rechazado" value="{{empresa.orden_rechazada_asunto}}">
                              </div>
                              <div class="form-group">
                                <label for="rechazado_note">Nota para solicitudes rechazadas:</label> 
                                <textarea class="form-control form-control-sm" name="rechazado_note" id="rechazado_note" >{{ empresa.rechazado_note or '' }}</textarea> 
                              </div> 
                              <hr>
                               
                              <div class = "text-info mt-2"> 
                                <h5> Mail GENERACIÓN CUPÓN: </h5>
                              </div> 
                              <p>Este mail se envía al generar un cupón de crédito. <br> </p>
                              <div class="form-group">
                                <label for="asunto_cupon">Asunto al generar un cupón</label> 
                                <input type="text" class="form-control form-control-sm" name="asunto_cupon" id="asunto_cupon" value="{{empresa.cupon_generado_asunto}}">
                              </div>
                              <div class="form-group">
                                <label for="cupon_generado_note">Nota para la generación de cupón:</label> 
                                <textarea class="form-control form-control-sm" name="cupon_generado_note" id="cupon_generado_note" >{{ empresa.cupon_generado_note or ''}}</textarea> 
                              </div> 
                              <hr>
                              
                                
                              <div class = "text-info mt-2"> 
                                <h5> Mail FINALIZACION: </h5>
                              </div>
                              <p>Este mail se envía al finalizar la gestión de una orden, en el momento en que se cierra la misma. <br> </p>
                              <div class="form-group">
                                <label for="asunto_finalizado">Asunto para solicitudes finzalidas</label> 
                                <input type="text" class="form-control form-control-sm" name="asunto_finalizado" id="asunto_finalizado" value="{{empresa.orden_finalizada_asunto}}">
                              </div>  
                              <div class="form-group">
                                <label for="finalizado_note">Nota para el final del procesamiento:</label> 
                                <textarea class="form-control form-control-sm" name="finalizado_note" id="finalizado_note" >{{ empresa.finalizado_note or '' }}</textarea> 
                              </div> 
                            </small>

                            <button name="boton" type="submit" class="btn btn-primary mt-2" value="guardar"> Guardar Cambios </button>
                            <button name="boton" type="submit" class="btn btn-danger mt-2 float-right" value="cancelar"> Salir </button>
                          </div>
                        </div>
                      </form>

                    </div>
                  </div> 


                  

              </div>
            </div>
          </div>
        </div>
      </div>
               
               
            
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
      $('#bloque_correo').hide(); 

      $('#nuevo_metodo_envio').change(function () { 
          buscar_metodo_envio($(this).val());
      });

      function buscar_metodo_envio(metodo_envio_id) {  
            $.post('/buscar_metodo_envio', {
                metodo_envio_id: metodo_envio_id
            }).done(function(response) {
              if (response == 'Si'){
                $('#bloque_correo').show(); 
              } else {
                $('#bloque_correo').hide(); 
              }
            }).fail(function(){
                alert('No existe el Método de Envío');
            })   
        }
      
   

    </script>
{% endblock %}
